<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="" MadCap:conditionTagExpression="" MadCap:ignoredWords="FBT;FBO" MadCap:lastBlockDepth="9" MadCap:lastHeight="4750" MadCap:lastWidth="714">
    <head>
        <link href="../../Resources/TableStyles/Note.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../Resources/TableStyles/Note.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../Resources/TableStyles/Note.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../Resources/TableStyles/Warning.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../Resources/TableStyles/Tableau standard.css" rel="stylesheet" MadCap:stylesheetType="table" /><title></title>
    </head>
    <body>
        <h1 class="LegacySXT"><MadCap:keyword term="Macro:setup" />Macros</h1>
        <p>Macros enable you to establish mathematical relationships between budget codes. There are two different types of macros.</p>
        <ul style="list-style-type: square;">
            <li class="PuceNiv1"><b>Horizontal</b> macros enable the correspondence between Operational Budget codes and Treasury Budget codes. The Treasury Budget amounts can then be calculated on the basis of the Operational Budget amounts. For example, in the Treasury Budget, you can break down the collection of a sale saved as a unique transaction in the Operational Budget.</li>
            <li class="PuceNiv1"><b>Vertical</b> macros define logical relationships between budget codes of a same budget.<br />For example, you can calculate the amount of fringe benefits on the basis of salaries.</li>
        </ul>
        <p class="SautLigne">You can create several macros for one budget code. Later on, when setting up the designer, you will be able to select one macro to apply to one budget code.</p>
        <p class="SautLigne">The range of possibilities in terms of calculation is wide. Here are some examples:</p>
        <ul style="list-style-type: square;">
            <li class="PuceNiv1">Distribution of an amount on different budget codes</li>
        </ul>
        <ul>
            <li class="PuceNiv1">Breakdown of the collection of a sale over a period of time</li>
        </ul>
        <p class="SautLigne">You can create a default macro for all the budget codes with identical amount and date, both in the Operational and Treasury Budgets.</p>
        <p class="SautLigneAvantEtAprès">To defer or break down the amounts of a budget code over time, distribute them on several budget codes, or associate them with a logical condition, you need to create a customized macro. Macros can include several lines of script.</p>
        <table style="mc-table-style: url('../../Resources/TableStyles/Warning.css');margin-left: 50px;margin-right: auto;" class="TableStyle-Warning" cellspacing="0">
            <col class="TableStyle-Warning-Column-Column1" />
            <col class="TableStyle-Warning-Column-Column2" />
            <tbody>
                <tr class="TableStyle-Warning-Body-Body1">
                    <td class="TableStyle-Warning-BodyB-Column1-Body1" style="text-align: left;"><img src="../../Resources/Images/Assets/oh-Warning.png" /></td>
                    <td class="TableStyle-Warning-BodyA-Column2-Body1">If you are a new user, see the topics <MadCap:xref href="PARAM - Assistant de regle de gestion.htm" target="" title="" alt="" class="XrefSansTexte">Macros Wizard</MadCap:xref> and <MadCap:xref href="PARAM - Exemples de regles.htm" target="" title="" alt="" class="XrefSansTexte">Examples of Macros</MadCap:xref>.</td>
                </tr>
            </tbody>
        </table>
        <p class="SautLigneAvantEtAprès">If two users are working on the same database, the user who created a macro first is the only one authorized to create more macros during the session.</p>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Accessing Setup Page for Macros</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <p>In the <MadCap:variable name="Localization.SXTModulesTasks" style="font-weight: bold;" /> pane, select the <b>Macro</b> option from the <b><MadCap:variable name="Localization.SXTSetupFolder" /></b> folder of the <MadCap:variable name="Localization.SXT_Liquidity" style="font-weight: bold;" /> module.</p>
                <ul style="list-style-type: square;">
                    <li class="PuceNiv1">If no filter has been set up for macros, the filter configuration page is displayed.</li>
                </ul>
                <p class="IndentPuceNiv1">The macro filters enables you to set up selection criteria to determine the macros to display in the setup page for macros.</p>
                <p class="IndentPuceNiv1"><MadCap:conditionalText MadCap:conditions="Default.ScreenOnly">See the following topic for more information on setting up filters for Macros.</MadCap:conditionalText></p>
                <ul style="list-style-type: square;">
                    <li class="PuceNiv1">If a filter has already been set up, the <b>Macro</b> page is displayed with a list of the set up macros in a table.</li>
                </ul>
                <p class="IndentPuceNiv1" MadCap:targetName="Capture Paramétrage Règle gestion"><img src="../../Resources/Images/L_Liquidity/Parametrer les regles de gestion 1.jpg" class="SAGE_screenshot" /></p>
                <p MadCap:conditions="Default.ScreenOnly" class="SautLigne">
                    <MadCap:toggler targets="Tableau Paramétrage Règle gestion">View Table Description</MadCap:toggler>
                </p>
                <table class="TableStyle-Tableau_standard" cellspacing="0" MadCap:targetName="Tableau Paramétrage Règle gestion" style="mc-table-style: url('../../Resources/TableStyles/Tableau standard.css');margin-left: auto;margin-right: auto;">
                    <col class="TableStyle-Tableau_standard-Column-Column1" />
                    <col class="TableStyle-Tableau_standard-Column-Column2" />
                    <thead>
                        <tr class="TableStyle-Tableau_standard-Head-Header1">
                            <th class="TableStyle-Tableau_standard-HeadE-Column1-Header1">Column header</th>
                            <th class="TableStyle-Tableau_standard-HeadD-Column2-Header1">Content</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="TableStyle-Tableau_standard-Body-Body1">
                            <td class="TableStyle-Tableau_standard-BodyE-Column1-Body1">Macro</td>
                            <td class="TableStyle-Tableau_standard-BodyD-Column2-Body1">Macro code</td>
                        </tr>
                        <tr class="TableStyle-Tableau_standard-Body-Body1">
                            <td class="TableStyle-Tableau_standard-BodyE-Column1-Body1">Description</td>
                            <td class="TableStyle-Tableau_standard-BodyD-Column2-Body1">Macro description</td>
                        </tr>
                        <tr class="TableStyle-Tableau_standard-Body-Body1">
                            <td class="TableStyle-Tableau_standard-BodyE-Column1-Body1">Budget Code</td>
                            <td class="TableStyle-Tableau_standard-BodyD-Column2-Body1">Budget code associated with the macro<br />This setting indicates that you will be able to apply this macro to a budget code specified when defining your budget sheet designer.</td>
                        </tr>
                        <tr class="TableStyle-Tableau_standard-Body-Body1">
                            <td class="TableStyle-Tableau_standard-BodyE-Column1-Body1">Formula</td>
                            <td class="TableStyle-Tableau_standard-BodyD-Column2-Body1">Calculation formula defining the relationships between budget codes</td>
                        </tr>
                        <tr class="TableStyle-Tableau_standard-Body-Body1">
                            <td class="TableStyle-Tableau_standard-BodyE-Column1-Body1">Default</td>
                            <td class="TableStyle-Tableau_standard-BodyD-Column2-Body1">A check mark is displayed, if it is the default macro defined for the specified budget code.</td>
                        </tr>
                        <tr class="TableStyle-Tableau_standard-Body-Body1">
                            <td class="TableStyle-Tableau_standard-BodyE-Column1-Body1">Operational Budget</td>
                            <td class="TableStyle-Tableau_standard-BodyD-Column2-Body1">A check mark is displayed, if the Operational Budget is used.</td>
                        </tr>
                        <tr class="TableStyle-Tableau_standard-Body-Body1">
                            <td class="TableStyle-Tableau_standard-BodyB-Column1-Body1">Treasury Budget</td>
                            <td class="TableStyle-Tableau_standard-BodyA-Column2-Body1">A check mark is displayed, if the Treasury Budget is used.</td>
                        </tr>
                    </tbody>
                </table>
                <MadCap:snippetBlock src="../../Resources/Snippets/L_SXT_Liquidity/Actions dans tableau page de parametrage.flsnp" />
                <MadCap:snippetBlock src="../../Resources/Snippets/L_SXT_Liquidity/Ref croisee Reorg tableau.flsnp" />
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Activating Automatic Creation of Default Macros</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <p>This function enables you to create simple macros automatically: the relationship established between a budget code of the Operational Budget and its match in the Treasury Budget includes neither calculation, nor deferment.</p>
                <p>In the toolbar at the top of the setup page for macros, click the <b>Create Default Macros</b> button.</p>
                <p>A standard macro is created for each budget code (and not system budget code) which has no macro.</p>
                <p>The new macros are displayed at the end of the macros table.</p>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Creating Customized Macros</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <ol>
                    <li class="PuceNumNiv1">In the setup page for macros, click the <b>Create</b> button.<br></br>The creation page is displayed.</li>
                </ol>
                <p class="IndentPuceNiv1" MadCap:targetName="Capture Création Règle gestion"><img src="../../Resources/Images/L_Liquidity/Parametrer les regles de gestion 2.jpg" class="SAGE_screenshot"></img></p>
                <ol MadCap:continue="true">
                    <li class="PuceNumNiv1">In the <b>Description</b> field, enter a description for the macro.<br />You can also modify the unique code automatically entered in the <b>Code</b> field.</li>
                    <li class="PuceNumNiv1">Select the budget code associated with the macro, as follows:</li>
                </ol>
                <ol style="list-style-type: lower-alpha;">
                    <li class="PuceNumNiv2">Click the button <img src="../../Resources/Images/L_Liquidity/Bouton Points de suspension.JPG" /> in the <b>Budget Code</b> area.<br />A contextual window shows the list of the available budget codes.<br /></li>
                </ol>
                <p class="IndentPuceNiv2" MadCap:targetName="Capture code budget"><img src="../../Resources/Images/L_Liquidity/Pop-up codes budget.JPG" class="SAGE_screenshot"></img></p>
                <ol style="list-style-type: lower-alpha;" MadCap:continue="true">
                    <li class="PuceNumNiv2">To select a budget code in the list, double-click the corresponding line or click the corresponding line, then click <b>OK</b>.<br />The code and description of the budget code are displayed in the creation page for macros.<br />The <b>Script</b> area is enabled and you can define the calculation formula of the macro.</li>
                </ol>
                <ol>
                    <li class="PuceNumNiv1" value="4">Select the <b>Default Macros</b> if you want this macro to be the default macro for this budget code.<br />As a consequence, when you define your budget sheet structure, this is the proposed default macro for the selected budget code.</li>
                </ol>
                <table style="mc-table-style: url('../../Resources/TableStyles/Note.css');margin-left: 50px;margin-right: auto;" class="TableStyle-Note" cellspacing="0">
                    <col class="TableStyle-Note-Column-Column1" />
                    <col class="TableStyle-Note-Column-Column2" />
                    <tbody>
                        <tr class="TableStyle-Note-Body-Body1">
                            <td style="text-align: left;" class="TableStyle-Note-BodyB-Column1-Body1"><img src="../../Resources/Images/Assets/oh-Note.png" /></td>
                            <td class="TableStyle-Note-BodyA-Column2-Body1">The <b>OBS</b> and <b>TBS</b> options are always dimmed, and automatically selected once the formula is set up. You do not have to do anything for these options.</td>
                        </tr>
                    </tbody>
                </table>
                <ol MadCap:continue="true">
                    <li class="PuceNumNiv1">To define each line of the formula, different methods are available:</li>
                </ol>
                <ol style="list-style-type: lower-alpha;">
                    <li class="PuceNumNiv2">You can launch the Macros Wizard by clicking <b>Macros Wizard</b> (recommended for new users).<br /><MadCap:conditionalText MadCap:conditions="Default.ScreenOnly">For more information, see the <MadCap:xref href="PARAM - Assistant de regle de gestion.htm" target="" title="" alt="" class="XrefSansTexte">Macros Wizard</MadCap:xref> topic.</MadCap:conditionalText></li>
                    <li class="PuceNumNiv2">You can define manually a macro using the <b>Arithmetical operators</b>, <b>Budget Codes</b> and <b>Period Steps</b> buttons (for advanced users).</li>
                </ol>
                <p class="IndentPuceNiv2"><MadCap:conditionalText MadCap:conditions="Default.ScreenOnly">See the <MadCap:xref href="ANNEXE - Regles de gestion.htm" target="" title="" alt="" class="XrefSansTexte"><MadCap:xref href="ANNEXE - Regles de gestion.htm" target="" title="" alt="" class="XrefSansTexte">Macros:</MadCap:xref> Functions, Keywords and Syntax</MadCap:xref> topic for more information on available options.</MadCap:conditionalText></p>
                <ul>
                    <li class="puceNiv3">To insert budget codes, arithmetical operators, dates or periods, click the corresponding buttons and then, in the contextual menu, click a line to select it.</li>
                    <li class="PuceNiv3">If you want to refer to a budget code in the Treasury Budget, insert an arobase (@ sign) after the budget code (without spaces).</li>
                </ul>
                <p class="IndentPuceNiv2">Before inserting elements, it is important to position your cursor in the right place inside the entry field.</p>
                <ol style="list-style-type: lower-alpha;" start="3">
                    <li class="PuceNumNiv2">You can also create the formula by manual entry of keywords and operators (for expert users).</li>
                    <li class="PuceNumNiv2">You may also copy the formula from an existing macro, and use it as it is or modify it.<br />To copy the formula, click the <b>Macros</b> button, then, in the contextual window, click a line to select the corresponding macro. The matching formula is copied in the <b>Script</b> field.<br /></li>
                </ol>
                <table style="mc-table-style: url('../../Resources/TableStyles/Note.css');margin-left: 50px;margin-right: auto;" class="TableStyle-Note" cellspacing="0">
                    <col class="TableStyle-Note-Column-Column1" />
                    <col class="TableStyle-Note-Column-Column2" />
                    <tbody>
                        <tr class="TableStyle-Note-Body-Body1">
                            <td style="text-align: left;" class="TableStyle-Note-BodyB-Column1-Body1"><img src="../../Resources/Images/Assets/oh-Note.png" /></td>
                            <td class="TableStyle-Note-BodyA-Column2-Body1">Concerning numerical values, the decimal separator is the period and not the comma.</td>
                        </tr>
                    </tbody>
                </table>
                <ol>
                    <li class="PuceNumNiv1" value="6">To define an additional formula, position your cursor on the first line of the area displaying formulas.<br />Each new formula is added below and the first created formula remains at the top of the list.</li>
                </ol>
                <p class="IndentPuceNiv1">The <b>OBS</b> and <b>TBS</b> options are automatically selected, once the macro formulas are set up.</p>
                <ul style="list-style-type: square;">
                    <li class="PuceNiv2">The automatic selection of the <b>OBS</b> option means that the Operational Budget is used.</li>
                    <li class="PuceNiv2">The automatic selection of the <b>TBS</b> option means that the Treasury Budget is used.</li>
                </ul>
                <p class="IndentPuceNiv1">
                    <MadCap:toggler targets="ValiderFormule;ValiderFormule2">Validating Formulas and Saving Macros</MadCap:toggler>
                </p>
                <ul MadCap:targetName="ValiderFormule">
                    <li class="PuceNiv2">If you created the formula <u>with the Wizard</u>, click the <b>OK</b> button to save the macro.</li>
                    <li class="PuceNiv2">If you created the formula <u>without the Wizard</u>, the validation button <img src="../../Resources/Images/L_Liquidity/BoutonValidationFormule.JPG" /> appears.</li>
                </ul>
                <ol MadCap:targetName="ValiderFormule2">
                    <li class="PuceNumNiv3">Click this button to validate the formula.<br />If the syntax is not correct, an error message is displayed at the bottom of the page.</li>
                    <li class="PuceNumNiv3">Correct the formula and revalidate.</li>
                    <li class="PuceNumNiv3">Once the formula is validated, click <b>OK</b> to save the macro.</li>
                </ol>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Creating Filters for Macros</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <p>The filters specific to macros, enable you to define the filtering criteria for the display of macros in the corresponding setup page. </p>
                <p class="SautLigneAvantEtAprès">You need to have previously defined at least one macro filter to access the macro setup.</p>
                <ol>
                    <li class="PuceNumNiv1">In the <b>Filters</b> toolbar on the setup page for macros, click the <b>Actions</b> button, then select the <b>Add</b> option.</li>
                </ol>
                <p class="IndentPuceNiv1">The creation page for macro filters is displayed.</p>
                <p MadCap:targetName="Capture creer filtre 1a" class="IndentPuceNiv1"><img src="../../Resources/Images/L_Liquidity/Creer filtre regle de gestion 1.jpg" class="SAGE_screenshot" /></p>
                <p class="IndentPuceNiv1">This page enables the definition of unique identification information for the filter.</p>
                <ol MadCap:continue="true">
                    <li class="PuceNumNiv1">Enter a code and a description for the filter in the <b>Code</b> and <b>Description</b> fields.</li>
                    <li class="PuceNumNiv1">Select the <b>Template Default Filter</b> option, if you want this filter to be applied by default when accessing the setup page for macros.</li>
                    <li class="PuceNumNiv1">If you want this filter to be exclusively accessed by yourself, select the <b>Private</b> option.</li>
                    <li class="PuceNumNiv1">You may add comments in the <b>Text</b> field (optional).</li>
                    <li class="PuceNumNiv1">Click the <b>Configure</b> button to set up the filter settings.</li>
                </ol>
                <p class="IndentPuceNiv1">The configuration page for filter settings is displayed.</p>
                <p class="IndentPuceNiv1" MadCap:targetName="Capture creer filtre 2a"><img src="../../Resources/Images/L_Liquidity/Creer filtre regle de gestion 2.jpg" class="SAGE_screenshot" /></p>
                <ol MadCap:continue="true">
                    <li class="PuceNumNiv1">In the <b>Budget Code Selection</b> area of the <b>Codes</b> tab, enable the option:</li>
                </ol>
                <ul style="list-style-type: square;">
                    <li class="PuceNiv2"><b>All</b> to display the macros associated with the standard budget codes and the system budget codes,</li>
                    <li class="PuceNiv2"><b>Budget Code</b> to display only the macros associated with a standard budget code,</li>
                    <li class="PuceNiv2"><b>System Codes</b> to display only the macros associated with a system budget code.</li>
                </ul>
                <ol start="8">
                    <li class="PuceNumNiv1">In the <b>Budget Codes</b> area, click the button <b>Select</b> to display the list of the set up budget codes. In the contextual window, enable the options corresponding to the budget codes that you want to select. Click the <img src="../../Resources/Images/L_Liquidity/Bouton coche bleue.JPG"></img> button to validate your selection.</li>
                </ol>
                <p class="IndentPuceNiv1">The selected budget codes are displayed in the <b>Budget Codes</b> area. The macros specific to the selected budget codes are displayed in the setup page for macros.</p>
                <ol MadCap:continue="true">
                    <li class="PuceNumNiv1">Click the <b>Options</b> tab.</li>
                </ol>
                <p class="IndentPuceNiv1" MadCap:targetName="Capture onglet options"><img src="../../Resources/Images/L_Liquidity/Creer filtre regle de gestion 3.jpg" class="SAGE_screenshot" /></p>
                <ol start="8" MadCap:continue="true">
                    <li class="PuceNumNiv1">In the <b>Use in</b> area, enable the option:</li>
                </ol>
                <ul style="list-style-type: square;">
                    <li class="PuceNiv2"><b>All</b> to cancel filtering at this level,</li>
                    <li class="PuceNiv2"><b>OBS and TBS use</b> to display only the macros that involve both the Operational Budget and the Treasury Budget,</li>
                    <li class="PuceNiv2"><b>Only OBS</b> to display only the macros that involve the Operational Budget,</li>
                    <li class="PuceNiv2"><b>Only TBS</b> to display only the macros that involve the Treasury Budget,</li>
                </ul>
                <ol start="11">
                    <li class="PuceNumNiv1">Enable the <b>Default only</b> option to display only the macros defined as default for a budget code.</li>
                </ol>
                <table style="mc-table-style: url('../../Resources/TableStyles/Note.css');margin-left: 50px;margin-right: auto;" class="TableStyle-Note" cellspacing="0">
                    <col class="TableStyle-Note-Column-Column1" />
                    <col class="TableStyle-Note-Column-Column2" />
                    <tbody>
                        <tr class="TableStyle-Note-Body-Body1">
                            <td style="text-align: left;" class="TableStyle-Note-BodyB-Column1-Body1"><img src="../../Resources/Images/Assets/oh-Note.png" /></td>
                            <td class="TableStyle-Note-BodyA-Column2-Body1">Each budget code can only have one default macro. This macro is used as default macro for the linked budget code.</td>
                        </tr>
                    </tbody>
                </table>
                <ol start="10" MadCap:continue="true">
                    <li class="PuceNumNiv1">Click the following buttons, as needed:</li>
                </ol>
                <ul style="list-style-type: square;">
                    <li class="PuceNiv2"><b>OK</b> to save the setup and display the setup page for macros,</li>
                    <li class="PuceNiv2"><b>Cancel</b> to cancel the setup and display the setup page for macros,</li>
                </ul>
                <p>For more information on the application, modification and deletion of Filters, see the <MadCap:conditionalText MadCap:conditions="Default.ScreenOnly"><MadCap:xref target="" title="" alt="" href="ANNEXE - GUI - Filtres.htm" class="XrefSansTexte">Filters</MadCap:xref> topic.</MadCap:conditionalText></p>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
    </body>
</html>